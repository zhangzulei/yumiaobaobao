package com.yumiaobaobao.app.taiking.taikingupdate.controller;

import com.alibaba.fastjson.JSON;
import com.yumiaobaobao.app.taiking.entity.TaiKing;
import com.yumiaobaobao.app.taiking.taikingupdate.service.TaiKingUpdateService;
import com.yumiaobaobao.app.user.comment.service.Serviceindex_discover;
import io.swagger.annotations.Api;
import io.swagger.annotations.ApiOperation;
import io.swagger.annotations.ApiParam;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

/**
 * Created by WH on 2019/04/10.
 */
@RestController
@Component
@Api(tags = "专题操作 1.发布新专题 2.查询所有专题  3.查看专题的相关商户  4.查看专题下的便签（推荐，最新，最热）")
public class TaiKingUpdateController {

    @Autowired
    private TaiKingUpdateService taiKingUpdateService ;
    @Autowired
    private Serviceindex_discover serviceindex_discover;

    @RequestMapping(value ="/addTalKing" ,method = RequestMethod.POST)
    @ApiOperation(value="新增专题", notes="新增专题 Message:0 新增失败 1新增成功")
    public String addTalKing(
            @ApiParam("专题标签") @RequestParam("TalKingTitle")String TalKingTitle,
            @ApiParam("专题描述") @RequestParam("TalKingNote")String TalKingNote

    ){
        Map<String,Object> map = new HashMap<>();
        map.put("TalKingTitle",TalKingTitle);
        map.put("TalKingNote",TalKingNote);
        if(taiKingUpdateService.addTalKing(map)<1){
            return "{\"Message\": \"0\"}";
        }
        return "{\"Message\": \"1\"}";
    }

    @RequestMapping(value ="/allTalKing" ,method = RequestMethod.GET)
    @ApiOperation(value="查询最热专题", notes="查询最热专题 Message:0 没有数据 1查询成功")
    public String allTalKing(){
        List<TaiKing> taiKings = taiKingUpdateService.selectHoeTalking();
        if(taiKings==null||taiKings.size()<=0){
            return "{\"Message\": \"0\"}";
        }
        return "{\"Message\": \"1\", \"Data\":"+ JSON.toJSONString(taiKings)+"}";
    }

    @RequestMapping(value ="/recommendNotes" ,method = RequestMethod.GET)
    @ApiOperation(value="专题下推荐的便签（显示50条）", notes="专题下推荐的便签（显示50条） Message:0 没有数据 1查询成功")
    public String recommendNotes(@ApiParam("专题id") @RequestParam("talkingid")String talkingid){
        List<String> strings = serviceindex_discover.recommendNotes(Integer.valueOf(talkingid));
        if (strings==null||strings.size()<=0) {
            return "{\"Message\":\"0\"}";
        }
        return "{\"Message\":\"0\",\"Data\":"+JSON.toJSONString(strings)+"}";
    }

    @RequestMapping(value ="/selectNewTalking" ,method = RequestMethod.GET)
    @ApiOperation(value="查询最新专题", notes="查询最新专题 Message:0 没有数据 1查询成功")
    public String selectNewTalking(){
        List<TaiKing> taiKings = taiKingUpdateService.selectNewTalking();
        if (taiKings==null||taiKings.size()<=0) {
            return "{\"Message\":\"0\"}";
        }
        return "{\"Message\":\"0\",\"Data\":"+JSON.toJSONString(taiKings)+"}";
    }
}
